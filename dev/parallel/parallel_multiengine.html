

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>IPython’s Direct interface &mdash; IPython 0.13.dev documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.13.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="IPython 0.13.dev documentation" href="../index.html" />
    <link rel="up" title="Using IPython for parallel computing" href="index.html" />
    <link rel="next" title="The IPython task interface" href="parallel_task.html" />
    <link rel="prev" title="Starting the IPython controller and engines" href="parallel_process.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/logo.png" border="0" alt="IPython Documentation"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="parallel_task.html" title="The IPython task interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="parallel_process.html" title="Starting the IPython controller and engines"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li><a href="index.html" accesskey="U">Using IPython for parallel computing</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">IPython&#8217;s Direct interface</a><ul>
<li><a class="reference internal" href="#starting-the-ipython-controller-and-engines">Starting the IPython controller and engines</a></li>
<li><a class="reference internal" href="#creating-a-directview-instance">Creating a <tt class="docutils literal"><span class="pre">DirectView</span></tt> instance</a></li>
<li><a class="reference internal" href="#quick-and-easy-parallelism">Quick and easy parallelism</a><ul>
<li><a class="reference internal" href="#parallel-map">Parallel map</a></li>
<li><a class="reference internal" href="#remote-function-decorators">Remote function decorators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calling-python-functions">Calling Python functions</a><ul>
<li><a class="reference internal" href="#apply">apply</a></li>
<li><a class="reference internal" href="#blocking-execution">Blocking execution</a></li>
<li><a class="reference internal" href="#non-blocking-execution">Non-blocking execution</a></li>
<li><a class="reference internal" href="#the-block-and-targets-keyword-arguments-and-attributes">The <tt class="docutils literal"><span class="pre">block</span></tt> and <tt class="docutils literal"><span class="pre">targets</span></tt> keyword arguments and attributes</a></li>
<li><a class="reference internal" href="#parallel-magic-commands">Parallel magic commands</a><ul>
<li><a class="reference internal" href="#px-cell-magic"><tt class="docutils literal"><span class="pre">%%px</span></tt> Cell Magic</a></li>
<li><a class="reference internal" href="#result-magic"><tt class="docutils literal"><span class="pre">%result</span></tt> Magic</a></li>
<li><a class="reference internal" href="#autopx"><tt class="docutils literal"><span class="pre">%autopx</span></tt></a></li>
<li><a class="reference internal" href="#engines-as-kernels">Engines as Kernels</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#moving-python-objects-around">Moving Python objects around</a><ul>
<li><a class="reference internal" href="#basic-push-and-pull">Basic push and pull</a></li>
<li><a class="reference internal" href="#dictionary-interface">Dictionary interface</a></li>
<li><a class="reference internal" href="#scatter-and-gather">Scatter and gather</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-things-to-look-at">Other things to look at</a><ul>
<li><a class="reference internal" href="#how-to-do-parallel-list-comprehensions">How to do parallel list comprehensions</a></li>
<li><a class="reference internal" href="#remote-imports">Remote imports</a></li>
<li><a class="reference internal" href="#parallel-exceptions">Parallel exceptions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="parallel_process.html"
                        title="previous chapter">Starting the IPython controller and engines</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="parallel_task.html"
                        title="next chapter">The IPython task interface</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/parallel/parallel_multiengine.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="ipython-s-direct-interface">
<span id="parallel-multiengine"></span><h1>IPython&#8217;s Direct interface<a class="headerlink" href="#ipython-s-direct-interface" title="Permalink to this headline">¶</a></h1>
<p>The direct, or multiengine, interface represents one possible way of working with a set of
IPython engines. The basic idea behind the multiengine interface is that the
capabilities of each engine are directly and explicitly exposed to the user.
Thus, in the multiengine interface, each engine is given an id that is used to
identify the engine and give it work to do. This interface is very intuitive
and is designed with interactive usage in mind, and is the best place for
new users of IPython to begin.</p>
<div class="section" id="starting-the-ipython-controller-and-engines">
<h2>Starting the IPython controller and engines<a class="headerlink" href="#starting-the-ipython-controller-and-engines" title="Permalink to this headline">¶</a></h2>
<p>To follow along with this tutorial, you will need to start the IPython
controller and four IPython engines. The simplest way of doing this is to use
the <strong class="command">ipcluster</strong> command:</p>
<div class="highlight-python"><pre>$ ipcluster start -n 4</pre>
</div>
<p>For more detailed information about starting the controller and engines, see
our <a class="reference internal" href="parallel_intro.html#parallel-overview"><em>introduction</em></a> to using IPython for parallel computing.</p>
</div>
<div class="section" id="creating-a-directview-instance">
<h2>Creating a <tt class="docutils literal"><span class="pre">DirectView</span></tt> instance<a class="headerlink" href="#creating-a-directview-instance" title="Permalink to this headline">¶</a></h2>
<p>The first step is to import the IPython <a class="reference internal" href="../api/generated/IPython.parallel.html#module-IPython.parallel" title="IPython.parallel"><tt class="xref py py-mod docutils literal"><span class="pre">IPython.parallel</span></tt></a>
module and then create a <a class="reference internal" href="../api/generated/IPython.parallel.client.client.html#IPython.parallel.client.client.Client" title="IPython.parallel.client.client.Client"><tt class="xref py py-class docutils literal"><span class="pre">Client</span></tt></a> instance:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">IPython.parallel</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="gp">In [2]: </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
</pre></div>
</div>
<p>This form assumes that the default connection information (stored in
<tt class="file docutils literal"><span class="pre">ipcontroller-client.json</span></tt> found in <tt class="file docutils literal"><span class="pre">IPYTHONDIR/profile_default/security</span></tt>) is
accurate. If the controller was started on a remote machine, you must copy that connection
file to the client machine, or enter its contents as arguments to the Client constructor:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="c"># If you have copied the json connector file from the controller:</span>
<span class="gp">In [2]: </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s">&#39;/path/to/ipcontroller-client.json&#39;</span><span class="p">)</span>
<span class="c"># or to connect with a specific profile you have set up:</span>
<span class="gp">In [3]: </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="s">&#39;mpi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To make sure there are engines connected to the controller, users can get a list
of engine ids:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [3]: </span><span class="n">rc</span><span class="o">.</span><span class="n">ids</span>
<span class="gr">Out[3]: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>Here we see that there are four engines ready to do work for us.</p>
<p>For direct execution, we will make use of a <tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt> object, which can be
constructed via list-access to the client:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [4]: </span><span class="n">dview</span> <span class="o">=</span> <span class="n">rc</span><span class="p">[:]</span> <span class="c"># use all engines</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">For more information, see the in-depth explanation of <a class="reference internal" href="parallel_details.html#parallel-details"><em>Views</em></a>.</p>
</div>
</div>
<div class="section" id="quick-and-easy-parallelism">
<h2>Quick and easy parallelism<a class="headerlink" href="#quick-and-easy-parallelism" title="Permalink to this headline">¶</a></h2>
<p>In many cases, you simply want to apply a Python function to a sequence of
objects, but <em>in parallel</em>. The client interface provides a simple way
of accomplishing this: using the DirectView&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">map()</span></tt> method.</p>
<div class="section" id="parallel-map">
<h3>Parallel map<a class="headerlink" href="#parallel-map" title="Permalink to this headline">¶</a></h3>
<p>Python&#8217;s builtin <tt class="xref py py-func docutils literal"><span class="pre">map()</span></tt> functions allows a function to be applied to a
sequence element-by-element. This type of code is typically trivial to
parallelize. In fact, since IPython&#8217;s interface is all about functions anyway,
you can just use the builtin <tt class="xref py py-func docutils literal"><span class="pre">map()</span></tt> with a <tt class="xref py py-class docutils literal"><span class="pre">RemoteFunction</span></tt>, or a
DirectView&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">map()</span></tt> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [62]: </span><span class="n">serial_result</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>

<span class="gp">In [63]: </span><span class="n">parallel_result</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">map_sync</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>

<span class="gp">In [67]: </span><span class="n">serial_result</span><span class="o">==</span><span class="n">parallel_result</span>
<span class="gr">Out[67]: </span><span class="bp">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt>&#8216;s version of <tt class="xref py py-meth docutils literal"><span class="pre">map()</span></tt> does
not do dynamic load balancing. For a load balanced version, use a
<tt class="xref py py-class docutils literal"><span class="pre">LoadBalancedView</span></tt>.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><tt class="xref py py-meth docutils literal"><span class="pre">map()</span></tt> is implemented via <tt class="xref py py-class docutils literal"><span class="pre">ParallelFunction</span></tt>.</p>
</div>
</div>
<div class="section" id="remote-function-decorators">
<h3>Remote function decorators<a class="headerlink" href="#remote-function-decorators" title="Permalink to this headline">¶</a></h3>
<p>Remote functions are just like normal functions, but when they are called,
they execute on one or more engines, rather than locally. IPython provides
two decorators:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="nd">@dview.remote</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   ....:</span> <span class="k">def</span> <span class="nf">getpid</span><span class="p">():</span>
<span class="gp">   ....:</span>     <span class="kn">import</span> <span class="nn">os</span>
<span class="gp">   ....:</span>     <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span>
<span class="gp">   ....:</span>

<span class="gp">In [11]: </span><span class="n">getpid</span><span class="p">()</span>
<span class="gr">Out[11]: </span><span class="p">[</span><span class="mi">12345</span><span class="p">,</span> <span class="mi">12346</span><span class="p">,</span> <span class="mi">12347</span><span class="p">,</span> <span class="mi">12348</span><span class="p">]</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">&#64;parallel</span></tt> decorator creates parallel functions, that break up an element-wise
operations and distribute them, reconstructing the result.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [12]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">In [13]: </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">64</span><span class="p">,</span><span class="mi">48</span><span class="p">))</span>

<span class="gp">In [14]: </span><span class="nd">@dview.parallel</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   ....:</span> <span class="k">def</span> <span class="nf">pmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
<span class="gp">   ....:</span>     <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">B</span>

<span class="gp">In [15]: </span><span class="n">C_local</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">A</span>

<span class="gp">In [16]: </span><span class="n">C_remote</span> <span class="o">=</span> <span class="n">pmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="p">(</span><span class="n">C_local</span> <span class="o">==</span> <span class="n">C_remote</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gr">Out[17]: </span><span class="bp">True</span>
</pre></div>
</div>
<p>Calling a <tt class="docutils literal"><span class="pre">&#64;parallel</span></tt> function <em>does not</em> correspond to map. It is used for splitting
element-wise operations that operate on a sequence or array.  For <tt class="docutils literal"><span class="pre">map</span></tt> behavior,
parallel functions do have a map method.</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="36%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">call</th>
<th class="head">pfunc(seq)</th>
<th class="head">pfunc.map(seq)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td># of tasks</td>
<td># of engines (1 per engine)</td>
<td># of engines (1 per engine)</td>
</tr>
<tr class="row-odd"><td># of remote calls</td>
<td># of engines (1 per engine)</td>
<td><tt class="docutils literal"><span class="pre">len(seq)</span></tt></td>
</tr>
<tr class="row-even"><td>argument to remote</td>
<td><tt class="docutils literal"><span class="pre">seq[i:j]</span></tt> (sub-sequence)</td>
<td><tt class="docutils literal"><span class="pre">seq[i]</span></tt> (single element)</td>
</tr>
</tbody>
</table>
<p>A quick example to illustrate the difference in arguments for the two modes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="nd">@dview.parallel</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">   ....:</span> <span class="k">def</span> <span class="nf">echo</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ....:</span>     <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">   ....:</span>

<span class="gp">In [17]: </span><span class="n">echo</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gr">Out[17]: </span><span class="p">[</span><span class="s">&#39;[0, 1]&#39;</span><span class="p">,</span> <span class="s">&#39;[2]&#39;</span><span class="p">,</span> <span class="s">&#39;[3]&#39;</span><span class="p">,</span> <span class="s">&#39;[4]&#39;</span><span class="p">]</span>

<span class="gp">In [18]: </span><span class="n">echo</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gr">Out[18]: </span><span class="p">[</span><span class="s">&#39;0&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="s">&#39;4&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See the <a class="reference internal" href="../api/generated/IPython.parallel.client.remotefunction.html#IPython.parallel.client.remotefunction.parallel" title="IPython.parallel.client.remotefunction.parallel"><tt class="xref py py-func docutils literal"><span class="pre">parallel()</span></tt></a> and <a class="reference internal" href="../api/generated/IPython.parallel.client.remotefunction.html#IPython.parallel.client.remotefunction.remote" title="IPython.parallel.client.remotefunction.remote"><tt class="xref py py-func docutils literal"><span class="pre">remote()</span></tt></a>
decorators for options.</p>
</div>
</div>
</div>
<div class="section" id="calling-python-functions">
<h2>Calling Python functions<a class="headerlink" href="#calling-python-functions" title="Permalink to this headline">¶</a></h2>
<p>The most basic type of operation that can be performed on the engines is to
execute Python code or call Python functions. Executing Python code can be
done in blocking or non-blocking mode (non-blocking is default) using the
<tt class="xref py py-meth docutils literal"><span class="pre">View.execute()</span></tt> method, and calling functions can be done via the
<a class="reference internal" href="../api/generated/IPython.parallel.client.view.html#IPython.parallel.client.view.View.apply" title="IPython.parallel.client.view.View.apply"><tt class="xref py py-meth docutils literal"><span class="pre">View.apply()</span></tt></a> method.</p>
<div class="section" id="apply">
<h3>apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h3>
<p>The main method for doing remote execution (in fact, all methods that
communicate with the engines are built on top of it), is <tt class="xref py py-meth docutils literal"><span class="pre">View.apply()</span></tt>.</p>
<p>We strive to provide the cleanest interface we can, so <cite>apply</cite> has the following
signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">view</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>There are various ways to call functions with IPython, and these flags are set as
attributes of the View.  The <tt class="docutils literal"><span class="pre">DirectView</span></tt> has just two of these flags:</p>
<dl class="docutils">
<dt>dv.block <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>whether to wait for the result, or return an <a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> object
immediately</dd>
<dt>dv.track <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>whether to instruct pyzmq to track when zeromq is done sending the message.
This is primarily useful for non-copying sends of numpy arrays that you plan to
edit in-place.  You need to know when it becomes safe to edit the buffer
without corrupting the message.</dd>
<dt>dv.targets <span class="classifier-delimiter">:</span> <span class="classifier">int, list of ints</span></dt>
<dd>which targets this view is associated with.</dd>
</dl>
<p>Creating a view is simple: index-access on a client creates a <a class="reference internal" href="../api/generated/IPython.parallel.client.view.html#IPython.parallel.client.view.DirectView" title="IPython.parallel.client.view.DirectView"><tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt></a>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [4]: </span><span class="n">view</span> <span class="o">=</span> <span class="n">rc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gr">Out[4]: </span><span class="o">&lt;</span><span class="n">DirectView</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span>

<span class="gp">In [5]: </span><span class="n">view</span><span class="o">.</span><span class="n">apply</span><span class="o">&lt;</span><span class="n">tab</span><span class="o">&gt;</span>
<span class="go">view.apply  view.apply_async  view.apply_sync</span>
</pre></div>
</div>
<p>For convenience, you can set block temporarily for a single call with the extra sync/async methods.</p>
</div>
<div class="section" id="blocking-execution">
<h3>Blocking execution<a class="headerlink" href="#blocking-execution" title="Permalink to this headline">¶</a></h3>
<p>In blocking mode, the <a class="reference internal" href="../api/generated/IPython.parallel.client.view.html#IPython.parallel.client.view.DirectView" title="IPython.parallel.client.view.DirectView"><tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt></a> object (called <tt class="docutils literal"><span class="pre">dview</span></tt> in
these examples) submits the command to the controller, which places the
command in the engines&#8217; queues for execution. The <tt class="xref py py-meth docutils literal"><span class="pre">apply()</span></tt> call then
blocks until the engines are done executing the command:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">dview</span> <span class="o">=</span> <span class="n">rc</span><span class="p">[:]</span> <span class="c"># A DirectView of all engines</span>
<span class="gp">In [3]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span>
<span class="gp">In [4]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [5]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="gp">In [6]: </span><span class="n">dview</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>
<span class="gr">Out[6]: </span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
</pre></div>
</div>
<p>You can also select blocking execution on a call-by-call basis with the <tt class="xref py py-meth docutils literal"><span class="pre">apply_sync()</span></tt>
method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">False</span>

<span class="gp">In [8]: </span><span class="n">dview</span><span class="o">.</span><span class="n">apply_sync</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="mi">27</span><span class="p">)</span>
<span class="gr">Out[8]: </span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
</pre></div>
</div>
<p>Python commands can be executed as strings on specific engines by using a View&#8217;s <tt class="docutils literal"><span class="pre">execute</span></tt>
method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">rc</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;c=a+b&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">rc</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;c=a-b&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]</span> <span class="c"># shorthand for dview.pull(&#39;c&#39;, block=True)</span>
<span class="gr">Out[8]: </span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="non-blocking-execution">
<h3>Non-blocking execution<a class="headerlink" href="#non-blocking-execution" title="Permalink to this headline">¶</a></h3>
<p>In non-blocking mode, <tt class="xref py py-meth docutils literal"><span class="pre">apply()</span></tt> submits the command to be executed and
then returns a <a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> object immediately. The
<a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> object gives you a way of getting a result at a later
time through its <tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt> method.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Docs on the <a class="reference internal" href="asyncresult.html#parallel-asyncresult"><em>AsyncResult</em></a> object.</p>
</div>
<p>This allows you to quickly submit long running commands without blocking your
local Python/IPython session:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="c"># define our function</span>
<span class="gp">In [6]: </span><span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="go">  ....:     import time</span>
<span class="go">  ....:     tic = time.time()</span>
<span class="go">  ....:     time.sleep(t)</span>
<span class="go">  ....:     return time.time()-tic</span>

<span class="c"># In non-blocking mode</span>
<span class="gp">In [7]: </span><span class="n">ar</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c"># Now block for the result</span>
<span class="gp">In [8]: </span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gr">Out[8]: </span><span class="p">[</span><span class="mf">2.0006198883056641</span><span class="p">,</span> <span class="mf">1.9997570514678955</span><span class="p">,</span> <span class="mf">1.9996809959411621</span><span class="p">,</span> <span class="mf">2.0003249645233154</span><span class="p">]</span>

<span class="c"># Again in non-blocking mode</span>
<span class="gp">In [9]: </span><span class="n">ar</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c"># Poll to see if the result is ready</span>
<span class="gp">In [10]: </span><span class="n">ar</span><span class="o">.</span><span class="n">ready</span><span class="p">()</span>
<span class="gr">Out[10]: </span><span class="bp">False</span>

<span class="c"># ask for the result, but wait a maximum of 1 second:</span>
<span class="gp">In [45]: </span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">TimeoutError                              Traceback (most recent call last)</span>
<span class="go">/home/you/&lt;ipython-input-45-7cd858bbb8e0&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 ar.get(1)</span>

<span class="go">/path/to/site-packages/IPython/parallel/asyncresult.pyc in get(self, timeout)</span>
<span class="go">     62                 raise self._exception</span>
<span class="go">     63         else:</span>
<span class="go">---&gt; 64             raise error.TimeoutError(&quot;Result not ready.&quot;)</span>
<span class="go">     65</span>
<span class="go">     66     def ready(self):</span>

<span class="go">TimeoutError: Result not ready.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note the import inside the function. This is a common model, to ensure
that the appropriate modules are imported where the task is run. You can
also manually import modules into the engine(s) namespace(s) via
<tt class="xref py py-meth docutils literal"><span class="pre">view.execute('import</span> <span class="pre">numpy')()</span></tt>.</p>
</div>
<p>Often, it is desirable to wait until a set of <a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> objects
are done. For this, there is a the method <tt class="xref py py-meth docutils literal"><span class="pre">wait()</span></tt>. This method takes a
tuple of <a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> objects (or <cite>msg_ids</cite> or indices to the client&#8217;s History),
and blocks until all of the associated results are ready:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [72]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">False</span>

<span class="c"># A trivial list of AsyncResults objects</span>
<span class="gp">In [73]: </span><span class="n">pr_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dview</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="c"># Wait until all of them are done</span>
<span class="gp">In [74]: </span><span class="n">dview</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">pr_list</span><span class="p">)</span>

<span class="c"># Then, their results are ready using get() or the `.r` attribute</span>
<span class="gp">In [75]: </span><span class="n">pr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gr">Out[75]: </span><span class="p">[</span><span class="mf">2.9982571601867676</span><span class="p">,</span> <span class="mf">2.9982588291168213</span><span class="p">,</span> <span class="mf">2.9987530708312988</span><span class="p">,</span> <span class="mf">2.9990990161895752</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-block-and-targets-keyword-arguments-and-attributes">
<h3>The <tt class="docutils literal"><span class="pre">block</span></tt> and <tt class="docutils literal"><span class="pre">targets</span></tt> keyword arguments and attributes<a class="headerlink" href="#the-block-and-targets-keyword-arguments-and-attributes" title="Permalink to this headline">¶</a></h3>
<p>Most DirectView methods (excluding <tt class="xref py py-meth docutils literal"><span class="pre">apply()</span></tt>) accept <tt class="docutils literal"><span class="pre">block</span></tt> and
<tt class="docutils literal"><span class="pre">targets</span></tt> as keyword arguments. As we have seen above, these keyword arguments control the
blocking mode and which engines the command is applied to. The <tt class="xref py py-class docutils literal"><span class="pre">View</span></tt> class also has
<tt class="xref py py-attr docutils literal"><span class="pre">block</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">targets</span></tt> attributes that control the default behavior when the keyword
arguments are not provided. Thus the following logic is used for <tt class="xref py py-attr docutils literal"><span class="pre">block</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">targets</span></tt>:</p>
<ul class="simple">
<li>If no keyword argument is provided, the instance attributes are used.</li>
<li>The Keyword arguments, if provided overrides the instance attributes for
the duration of a single call.</li>
</ul>
<p>The following examples demonstrate how to use the instance attributes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="n">dview</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [17]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span> <span class="o">=</span> <span class="bp">False</span>

<span class="gp">In [18]: </span><span class="n">ar</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gr">Out[19]: </span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="gp">In [20]: </span><span class="n">dview</span><span class="o">.</span><span class="n">targets</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">ids</span> <span class="c"># all engines (4)</span>

<span class="gp">In [21]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span> <span class="o">=</span> <span class="bp">True</span>

<span class="gp">In [22]: </span><span class="n">dview</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="p">:</span> <span class="mi">42</span><span class="p">)</span>
<span class="gr">Out[22]: </span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">]</span>
</pre></div>
</div>
<p>The <tt class="xref py py-attr docutils literal"><span class="pre">block</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">targets</span></tt> instance attributes of the
<a class="reference internal" href="../api/generated/IPython.parallel.client.view.html#IPython.parallel.client.view.DirectView" title="IPython.parallel.client.view.DirectView"><tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt></a> also determine the behavior of the parallel magic commands.</p>
</div>
<div class="section" id="parallel-magic-commands">
<h3>Parallel magic commands<a class="headerlink" href="#parallel-magic-commands" title="Permalink to this headline">¶</a></h3>
<p>We provide a few IPython magic commands (<tt class="docutils literal"><span class="pre">%px</span></tt>, <tt class="docutils literal"><span class="pre">%autopx</span></tt> and <tt class="docutils literal"><span class="pre">%result</span></tt>)
that make it a bit more pleasant to execute Python commands on the engines interactively.
These are simply shortcuts to <a class="reference internal" href="../api/generated/IPython.parallel.client.view.html#IPython.parallel.client.view.DirectView.execute" title="IPython.parallel.client.view.DirectView.execute"><tt class="xref py py-meth docutils literal"><span class="pre">DirectView.execute()</span></tt></a>
and <a class="reference internal" href="../api/generated/IPython.parallel.client.asyncresult.html#IPython.parallel.client.asyncresult.AsyncResult.display_outputs" title="IPython.parallel.client.asyncresult.AsyncResult.display_outputs"><tt class="xref py py-meth docutils literal"><span class="pre">AsyncResult.display_outputs()</span></tt></a> methods repsectively.
The <tt class="docutils literal"><span class="pre">%px</span></tt> magic executes a single Python command on the engines
specified by the <tt class="xref py py-attr docutils literal"><span class="pre">targets</span></tt> attribute of the <tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt> instance:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="c"># Create a DirectView for all targets</span>
<span class="gp">In [22]: </span><span class="n">dv</span> <span class="o">=</span> <span class="n">rc</span><span class="p">[:]</span>

<span class="c"># Make this DirectView active for parallel magic commands</span>
<span class="gp">In [23]: </span><span class="n">dv</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>

<span class="gp">In [24]: </span><span class="n">dv</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span>

<span class="c"># import numpy here and everywhere</span>
<span class="gp">In [25]: </span><span class="k">with</span> <span class="n">dv</span><span class="o">.</span><span class="n">sync_imports</span><span class="p">():</span>
<span class="gp">   ....:</span>    <span class="kn">import</span> <span class="nn">numpy</span>
<span class="go">importing numpy on engine(s)</span>

<span class="gp">In [27]: </span><span class="o">%</span><span class="n">px</span> <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Parallel execution on engines: [0, 1, 2, 3]</span>

<span class="gp">In [28]: </span><span class="o">%</span><span class="n">px</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Parallel execution on engines: [0, 1, 2, 3]</span>
<span class="go">[0] Out[68]: array([ 0.77120707, -0.19448286])</span>
<span class="go">[1] Out[68]: array([ 1.10815921,  0.05110369])</span>
<span class="go">[2] Out[68]: array([ 0.74625527, -0.37475081])</span>
<span class="go">[3] Out[68]: array([ 0.72931905,  0.07159743])</span>

<span class="gp">In [29]: </span><span class="o">%</span><span class="n">px</span> <span class="k">print</span> <span class="s">&#39;hi&#39;</span>
<span class="go">Parallel execution on engine(s): [0, 1, 2, 3]</span>
<span class="go">[stdout:0] hi</span>
<span class="go">[stdout:1] hi</span>
<span class="go">[stdout:2] hi</span>
<span class="go">[stdout:3] hi</span>
</pre></div>
</div>
<p>Since engines are IPython as well, you can even run magics remotely:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [28]: </span><span class="o">%</span><span class="n">px</span> <span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
<span class="go">Parallel execution on engine(s): [0, 1, 2, 3]</span>
<span class="go">[stdout:0]</span>
<span class="go">Welcome to pylab, a matplotlib-based Python environment...</span>
<span class="go">For more information, type &#39;help(pylab)&#39;.</span>
<span class="go">[stdout:1]</span>
<span class="go">Welcome to pylab, a matplotlib-based Python environment...</span>
<span class="go">For more information, type &#39;help(pylab)&#39;.</span>
<span class="go">[stdout:2]</span>
<span class="go">Welcome to pylab, a matplotlib-based Python environment...</span>
<span class="go">For more information, type &#39;help(pylab)&#39;.</span>
<span class="go">[stdout:3]</span>
<span class="go">Welcome to pylab, a matplotlib-based Python environment...</span>
<span class="go">For more information, type &#39;help(pylab)&#39;.</span>
</pre></div>
</div>
<p>And once in pylab mode with the inline backend,
you can make plots and they will be displayed in your frontend
if it suports the inline figures (e.g. notebook or qtconsole):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [40]: </span><span class="o">%</span><span class="n">px</span> <span class="n">plot</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">Parallel execution on engine(s): [0, 1, 2, 3]</span>
<span class="go">&lt;plot0&gt;</span>
<span class="go">&lt;plot1&gt;</span>
<span class="go">&lt;plot2&gt;</span>
<span class="go">&lt;plot3&gt;</span>
<span class="go">[0] Out[79]: [&lt;matplotlib.lines.Line2D at 0x10a6286d0&gt;]</span>
<span class="go">[1] Out[79]: [&lt;matplotlib.lines.Line2D at 0x10b9476d0&gt;]</span>
<span class="go">[2] Out[79]: [&lt;matplotlib.lines.Line2D at 0x110652750&gt;]</span>
<span class="go">[3] Out[79]: [&lt;matplotlib.lines.Line2D at 0x10c6566d0&gt;]</span>
</pre></div>
</div>
<div class="section" id="px-cell-magic">
<h4><tt class="docutils literal"><span class="pre">%%px</span></tt> Cell Magic<a class="headerlink" href="#px-cell-magic" title="Permalink to this headline">¶</a></h4>
<p><cite>%%px</cite> can also be used as a Cell Magic, which accepts <tt class="docutils literal"><span class="pre">--[no]block</span></tt> flags,
and a <tt class="docutils literal"><span class="pre">--group-outputs</span></tt> argument, which adjust how the outputs of multiple
engines are presented.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../api/generated/IPython.parallel.client.asyncresult.html#IPython.parallel.client.asyncresult.AsyncResult.display_outputs" title="IPython.parallel.client.asyncresult.AsyncResult.display_outputs"><tt class="xref py py-meth docutils literal"><span class="pre">AsyncResult.display_outputs()</span></tt></a> for the grouping options.</p>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [50]: </span><span class="o">%%</span><span class="n">px</span> <span class="o">--</span><span class="n">block</span> <span class="o">--</span><span class="n">group</span><span class="o">-</span><span class="n">outputs</span><span class="o">=</span><span class="n">engine</span>
<span class="gp">   ....:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">   ....:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">   ....:</span> <span class="n">ev</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">   ....:</span> <span class="k">print</span> <span class="n">ev</span>
<span class="gp">   ....:</span> <span class="n">ev</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gp">   ....:</span>
<span class="go">Parallel execution on engine(s): [0, 1, 2, 3]</span>
<span class="go">[stdout:0] [ 0.60640442  0.95919621]</span>
<span class="go">[0] Out[73]: 0.9591962130899806</span>
<span class="go">[stdout:1] [ 0.38501813  1.29430871]</span>
<span class="go">[1] Out[73]: 1.2943087091452372</span>
<span class="go">[stdout:2] [-0.85925141  0.9387692 ]</span>
<span class="go">[2] Out[73]: 0.93876920456230284</span>
<span class="go">[stdout:3] [ 0.37998269  1.24218246]</span>
<span class="go">[3] Out[73]: 1.2421824618493817</span>
</pre></div>
</div>
</div>
<div class="section" id="result-magic">
<h4><tt class="docutils literal"><span class="pre">%result</span></tt> Magic<a class="headerlink" href="#result-magic" title="Permalink to this headline">¶</a></h4>
<p>If you are using <tt class="docutils literal"><span class="pre">%px</span></tt> in non-blocking mode, you won&#8217;t get output.
You can use <tt class="docutils literal"><span class="pre">%result</span></tt> to display the outputs of the latest command,
just as is done when <tt class="docutils literal"><span class="pre">%px</span></tt> is blocking:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [39]: </span><span class="n">dv</span><span class="o">.</span><span class="n">block</span> <span class="o">=</span> <span class="bp">False</span>

<span class="gp">In [40]: </span><span class="o">%</span><span class="n">px</span> <span class="k">print</span> <span class="s">&#39;hi&#39;</span>
<span class="go">Async parallel execution on engine(s): [0, 1, 2, 3]</span>

<span class="gp">In [41]: </span><span class="o">%</span><span class="n">result</span>
<span class="go">[stdout:0] hi</span>
<span class="go">[stdout:1] hi</span>
<span class="go">[stdout:2] hi</span>
<span class="go">[stdout:3] hi</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">%result</span></tt> simply calls <a class="reference internal" href="../api/generated/IPython.parallel.client.asyncresult.html#IPython.parallel.client.asyncresult.AsyncResult.display_outputs" title="IPython.parallel.client.asyncresult.AsyncResult.display_outputs"><tt class="xref py py-meth docutils literal"><span class="pre">AsyncResult.display_outputs()</span></tt></a> on the most recent request.
You can pass integers as indices if you want a result other than the latest,
e.g. <tt class="docutils literal"><span class="pre">%result</span> <span class="pre">-2</span></tt>, or <tt class="docutils literal"><span class="pre">%result</span> <span class="pre">0</span></tt> for the first.</p>
</div>
<div class="section" id="autopx">
<h4><tt class="docutils literal"><span class="pre">%autopx</span></tt><a class="headerlink" href="#autopx" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">%autopx</span></tt> magic switches to a mode where everything you type is executed
on the engines until you do <tt class="docutils literal"><span class="pre">%autopx</span></tt> again.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [30]: </span><span class="n">dv</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span>

<span class="gp">In [31]: </span><span class="o">%</span><span class="n">autopx</span>
<span class="go">%autopx enabled</span>

<span class="gp">In [32]: </span><span class="n">max_evals</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [33]: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="gp">   ....:</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">   ....:</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">   ....:</span>     <span class="n">evals</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">   ....:</span>     <span class="n">max_evals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="gp">   ....:</span>

<span class="gp">In [34]: </span><span class="k">print</span> <span class="s">&quot;Average max eigenvalue is: </span><span class="si">%f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">max_evals</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">max_evals</span><span class="p">))</span>
<span class="go">[stdout:0] Average max eigenvalue is: 10.193101</span>
<span class="go">[stdout:1] Average max eigenvalue is: 10.064508</span>
<span class="go">[stdout:2] Average max eigenvalue is: 10.055724</span>
<span class="go">[stdout:3] Average max eigenvalue is: 10.086876</span>

<span class="gp">In [35]: </span><span class="o">%</span><span class="n">autopx</span>
<span class="go">Auto Parallel Disabled</span>
</pre></div>
</div>
</div>
<div class="section" id="engines-as-kernels">
<h4>Engines as Kernels<a class="headerlink" href="#engines-as-kernels" title="Permalink to this headline">¶</a></h4>
<p>Engines are really the same object as the Kernels used elsewhere in IPython,
with the minor exception that engines connect to a controller, while regular kernels
bind their sockets, listening for connections from a QtConsole or other frontends.</p>
<p>Sometimes for debugging or inspection purposes, you would like a QtConsole connected
to an engine for more direct interaction.  You can do this by first instructing
the Engine to <em>also</em> bind its kernel, to listen for connections:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [50]: </span><span class="o">%</span><span class="n">px</span> <span class="kn">from</span> <span class="nn">IPython.parallel</span> <span class="kn">import</span> <span class="n">bind_kernel</span><span class="p">;</span> <span class="n">bind_kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, if your engines are local, you can start a qtconsole right on the engine(s):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [51]: </span><span class="o">%</span><span class="n">px</span> <span class="o">%</span><span class="n">qtconsole</span>
</pre></div>
</div>
<p>Careful with this one, because if your view is of 16 engines it will start 16 QtConsoles!</p>
<p>Or you can view just the connection info, and work out the right way to connect to the engines,
depending on where they live and where you are:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [51]: </span><span class="o">%</span><span class="n">px</span> <span class="o">%</span><span class="n">connect_info</span>
<span class="go">Parallel execution on engine(s): [0, 1, 2, 3]</span>
<span class="go">[stdout:0]</span>
<span class="go">{</span>
<span class="go">  &quot;stdin_port&quot;: 60387,</span>
<span class="go">  &quot;ip&quot;: &quot;127.0.0.1&quot;,</span>
<span class="go">  &quot;hb_port&quot;: 50835,</span>
<span class="go">  &quot;key&quot;: &quot;eee2dd69-7dd3-4340-bf3e-7e2e22a62542&quot;,</span>
<span class="go">  &quot;shell_port&quot;: 55328,</span>
<span class="go">  &quot;iopub_port&quot;: 58264</span>
<span class="go">}</span>

<span class="go">Paste the above JSON into a file, and connect with:</span>
<span class="go">    $&gt; ipython &lt;app&gt; --existing &lt;file&gt;</span>
<span class="go">or, if you are local, you can connect with just:</span>
<span class="go">    $&gt; ipython &lt;app&gt; --existing kernel-60125.json</span>
<span class="go">or even just:</span>
<span class="go">    $&gt; ipython &lt;app&gt; --existing</span>
<span class="go">if this is the most recent IPython session you have started.</span>
<span class="go">[stdout:1]</span>
<span class="go">{</span>
<span class="go">  &quot;stdin_port&quot;: 61869,</span>
<span class="go">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">%qtconsole</span></tt> will call <tt class="xref py py-func docutils literal"><span class="pre">bind_kernel()</span></tt> on an engine if it hasn&#8217;t been done already,
so you can often skip that first step.</p>
</div>
</div>
</div>
</div>
<div class="section" id="moving-python-objects-around">
<h2>Moving Python objects around<a class="headerlink" href="#moving-python-objects-around" title="Permalink to this headline">¶</a></h2>
<p>In addition to calling functions and executing code on engines, you can
transfer Python objects to and from your IPython session and the engines. In
IPython, these operations are called <tt class="xref py py-meth docutils literal"><span class="pre">push()</span></tt> (sending an object to the
engines) and <tt class="xref py py-meth docutils literal"><span class="pre">pull()</span></tt> (getting an object from the engines).</p>
<div class="section" id="basic-push-and-pull">
<h3>Basic push and pull<a class="headerlink" href="#basic-push-and-pull" title="Permalink to this headline">¶</a></h3>
<p>Here are some examples of how you use <tt class="xref py py-meth docutils literal"><span class="pre">push()</span></tt> and <tt class="xref py py-meth docutils literal"><span class="pre">pull()</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [38]: </span><span class="n">dview</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mf">1.03234</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">3453</span><span class="p">))</span>
<span class="gr">Out[38]: </span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span>

<span class="gp">In [39]: </span><span class="n">dview</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gr">Out[39]: </span><span class="p">[</span> <span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">]</span>

<span class="gp">In [40]: </span><span class="n">dview</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[40]: </span><span class="mi">3453</span>

<span class="gp">In [41]: </span><span class="n">dview</span><span class="o">.</span><span class="n">pull</span><span class="p">((</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">))</span>
<span class="gr">Out[41]: </span><span class="p">[</span> <span class="p">[</span><span class="mf">1.03234</span><span class="p">,</span> <span class="mi">3453</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.03234</span><span class="p">,</span> <span class="mi">3453</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.03234</span><span class="p">,</span> <span class="mi">3453</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.03234</span><span class="p">,</span> <span class="mi">3453</span><span class="p">]</span> <span class="p">]</span>

<span class="gp">In [42]: </span><span class="n">dview</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s">&#39;speed&#39;</span><span class="p">))</span>
<span class="gr">Out[42]: </span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span>
</pre></div>
</div>
<p>In non-blocking mode <tt class="xref py py-meth docutils literal"><span class="pre">push()</span></tt> and <tt class="xref py py-meth docutils literal"><span class="pre">pull()</span></tt> also return
<a class="reference internal" href="parallel_details.html#AsyncResult" title="AsyncResult"><tt class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></tt></a> objects:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [48]: </span><span class="n">ar</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="gp">In [49]: </span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="gr">Out[49]: </span><span class="p">[</span><span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">,</span> <span class="mf">1.03234</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="dictionary-interface">
<h3>Dictionary interface<a class="headerlink" href="#dictionary-interface" title="Permalink to this headline">¶</a></h3>
<p>Since a Python namespace is just a <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>, <tt class="xref py py-class docutils literal"><span class="pre">DirectView</span></tt> objects provide
dictionary-style access by key and methods such as <tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt> and
<tt class="xref py py-meth docutils literal"><span class="pre">update()</span></tt> for convenience. This make the remote namespaces of the engines
appear as a local dictionary. Underneath, these methods call <tt class="xref py py-meth docutils literal"><span class="pre">apply()</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [51]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span><span class="s">&#39;bar&#39;</span><span class="p">]</span>

<span class="gp">In [52]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
<span class="gr">Out[52]: </span><span class="p">[</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="scatter-and-gather">
<h3>Scatter and gather<a class="headerlink" href="#scatter-and-gather" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it is useful to partition a sequence and push the partitions to
different engines. In MPI language, this is know as scatter/gather and we
follow that terminology. However, it is important to remember that in
IPython&#8217;s <tt class="xref py py-class docutils literal"><span class="pre">Client</span></tt> class, <tt class="xref py py-meth docutils literal"><span class="pre">scatter()</span></tt> is from the
interactive IPython session to the engines and <tt class="xref py py-meth docutils literal"><span class="pre">gather()</span></tt> is from the
engines back to the interactive IPython session. For scatter/gather operations
between engines, MPI, pyzmq, or some other direct interconnect should be used.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [58]: </span><span class="n">dview</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gr">Out[58]: </span><span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span>

<span class="gp">In [59]: </span><span class="n">dview</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">]</span>
<span class="gr">Out[59]: </span><span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span> <span class="p">]</span>

<span class="gp">In [60]: </span><span class="n">dview</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span>
<span class="gr">Out[60]: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="other-things-to-look-at">
<h2>Other things to look at<a class="headerlink" href="#other-things-to-look-at" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-to-do-parallel-list-comprehensions">
<h3>How to do parallel list comprehensions<a class="headerlink" href="#how-to-do-parallel-list-comprehensions" title="Permalink to this headline">¶</a></h3>
<p>In many cases list comprehensions are nicer than using the map function. While
we don&#8217;t have fully parallel list comprehensions, it is simple to get the
basic effect using <tt class="xref py py-meth docutils literal"><span class="pre">scatter()</span></tt> and <tt class="xref py py-meth docutils literal"><span class="pre">gather()</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [66]: </span><span class="n">dview</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">))</span>

<span class="gp">In [67]: </span><span class="o">%</span><span class="n">px</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="go">Parallel execution on engines: [0, 1, 2, 3]</span>

<span class="gp">In [68]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="s">&#39;y&#39;</span><span class="p">)</span>

<span class="gp">In [69]: </span><span class="k">print</span> <span class="n">y</span>
<span class="go">[0, 1, 1024, 59049, 1048576, 9765625, 60466176, 282475249, 1073741824,...]</span>
</pre></div>
</div>
</div>
<div class="section" id="remote-imports">
<h3>Remote imports<a class="headerlink" href="#remote-imports" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you will want to import packages both in your interactive session
and on your remote engines.  This can be done with the <tt class="xref py py-class docutils literal"><span class="pre">ContextManager</span></tt>
created by a DirectView&#8217;s <tt class="xref py py-meth docutils literal"><span class="pre">sync_imports()</span></tt> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [69]: </span><span class="k">with</span> <span class="n">dview</span><span class="o">.</span><span class="n">sync_imports</span><span class="p">():</span>
<span class="gp">   ....:</span>     <span class="kn">import</span> <span class="nn">numpy</span>
<span class="go">importing numpy on engine(s)</span>
</pre></div>
</div>
<p>Any imports made inside the block will also be performed on the view&#8217;s engines.
sync_imports also takes a <cite>local</cite> boolean flag that defaults to True, which specifies
whether the local imports should also be performed.  However, support for <cite>local=False</cite>
has not been implemented, so only packages that can be imported locally will work
this way.</p>
<p>You can also specify imports via the <tt class="docutils literal"><span class="pre">&#64;require</span></tt> decorator.  This is a decorator
designed for use in Dependencies, but can be used to handle remote imports as well.
Modules or module names passed to <tt class="docutils literal"><span class="pre">&#64;require</span></tt> will be imported before the decorated
function is called.  If they cannot be imported, the decorated function will never
execute and will fail with an UnmetDependencyError. Failures of single Engines will
be collected and raise a CompositeError, as demonstrated in the next section.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [69]: </span><span class="kn">from</span> <span class="nn">IPython.parallel</span> <span class="kn">import</span> <span class="n">require</span>

<span class="gp">In [70]: </span><span class="nd">@require</span><span class="p">(</span><span class="s">&#39;re&#39;</span><span class="p">):</span>
<span class="gp">   ....:</span> <span class="k">def</span> <span class="nf">findall</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">   ....:</span>     <span class="c"># re is guaranteed to be available</span>
<span class="gp">   ....:</span>     <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c"># you can also pass modules themselves, that you already have locally:</span>
<span class="gp">In [71]: </span><span class="nd">@require</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
<span class="gp">   ....:</span> <span class="k">def</span> <span class="nf">wait</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="gp">   ....:</span>     <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">   ....:</span>     <span class="k">return</span> <span class="n">t</span>
</pre></div>
</div>
</div>
<div class="section" id="parallel-exceptions">
<span id="id1"></span><h3>Parallel exceptions<a class="headerlink" href="#parallel-exceptions" title="Permalink to this headline">¶</a></h3>
<p>In the multiengine interface, parallel commands can raise Python exceptions,
just like serial commands. But, it is a little subtle, because a single
parallel command can actually raise multiple exceptions (one for each engine
the command was run on). To express this idea, we have a
<tt class="xref py py-exc docutils literal"><span class="pre">CompositeError</span></tt> exception class that will be raised in most cases. The
<tt class="xref py py-exc docutils literal"><span class="pre">CompositeError</span></tt> class is a special type of exception that wraps one or
more other types of exceptions. Here is how it works:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [76]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span>

<span class="gp">In [77]: </span><span class="n">dview</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;1/0&#39;</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">CompositeError                            Traceback (most recent call last)</span>
<span class="go">/home/user/&lt;ipython-input-10-5d56b303a66c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 dview.execute(&#39;1/0&#39;)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in execute(self, code, targets, block)</span>
<span class="go">    591                 default: self.block</span>
<span class="go">    592         &quot;&quot;&quot;</span>
<span class="go">--&gt; 593         return self._really_apply(util._execute, args=(code,), block=block, targets=targets)</span>
<span class="go">    594</span>
<span class="go">    595     def run(self, filename, targets=None, block=None):</span>

<span class="go">/home/user/&lt;string&gt; in _really_apply(self, f, args, kwargs, targets, block, track)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in sync_results(f, self, *args, **kwargs)</span>
<span class="go">     55 def sync_results(f, self, *args, **kwargs):</span>
<span class="go">     56     &quot;&quot;&quot;sync relevant results from self.client to our results attribute.&quot;&quot;&quot;</span>
<span class="go">---&gt; 57     ret = f(self, *args, **kwargs)</span>
<span class="go">     58     delta = self.outstanding.difference(self.client.outstanding)</span>
<span class="go">     59     completed = self.outstanding.intersection(delta)</span>

<span class="go">/home/user/&lt;string&gt; in _really_apply(self, f, args, kwargs, targets, block, track)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in save_ids(f, self, *args, **kwargs)</span>
<span class="go">     44     n_previous = len(self.client.history)</span>
<span class="go">     45     try:</span>
<span class="go">---&gt; 46         ret = f(self, *args, **kwargs)</span>
<span class="go">     47     finally:</span>
<span class="go">     48         nmsgs = len(self.client.history) - n_previous</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in _really_apply(self, f, args, kwargs, targets, block, track)</span>
<span class="go">    529         if block:</span>
<span class="go">    530             try:</span>
<span class="go">--&gt; 531                 return ar.get()</span>
<span class="go">    532             except KeyboardInterrupt:</span>
<span class="go">    533                 pass</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/asyncresult.pyc in get(self, timeout)</span>
<span class="go">    101                 return self._result</span>
<span class="go">    102             else:</span>
<span class="go">--&gt; 103                 raise self._exception</span>
<span class="go">    104         else:</span>
<span class="go">    105             raise error.TimeoutError(&quot;Result not ready.&quot;)</span>

<span class="go">CompositeError: one or more exceptions from call to method: _execute</span>
<span class="go">[0:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[1:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[2:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[3:apply]: ZeroDivisionError: integer division or modulo by zero</span>
</pre></div>
</div>
<p>Notice how the error message printed when <tt class="xref py py-exc docutils literal"><span class="pre">CompositeError</span></tt> is raised has
information about the individual exceptions that were raised on each engine.
If you want, you can even raise one of these original exceptions:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [80]: </span><span class="k">try</span><span class="p">:</span>
<span class="gp">   ....:</span>     <span class="n">dview</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;1/0&#39;</span><span class="p">)</span>
<span class="gp">   ....:</span> <span class="k">except</span> <span class="n">parallel</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">CompositeError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">   ....:</span>     <span class="n">e</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">()</span>
<span class="gp">   ....:</span>
<span class="gp">   ....:</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">RemoteError                               Traceback (most recent call last)</span>
<span class="go">/home/user/&lt;ipython-input-17-8597e7e39858&gt; in &lt;module&gt;()</span>
<span class="go">      2     dview.execute(&#39;1/0&#39;)</span>
<span class="go">      3 except CompositeError as e:</span>
<span class="go">----&gt; 4     e.raise_exception()</span>

<span class="go">/path/to/site-packages/IPython/parallel/error.pyc in raise_exception(self, excid)</span>
<span class="go">    266             raise IndexError(&quot;an exception with index %i does not exist&quot;%excid)</span>
<span class="go">    267         else:</span>
<span class="go">--&gt; 268             raise RemoteError(en, ev, etb, ei)</span>
<span class="go">    269</span>
<span class="go">    270</span>

<span class="go">RemoteError: ZeroDivisionError(integer division or modulo by zero)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/engine/streamkernel.py&quot;, line 330, in apply_request</span>
<span class="go">    exec code in working,working</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/util.py&quot;, line 354, in _execute</span>
<span class="go">    exec code in globals()</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">ZeroDivisionError: integer division or modulo by zero</span>
</pre></div>
</div>
<p>If you are working in IPython, you can simple type <tt class="docutils literal"><span class="pre">%debug</span></tt> after one of
these <tt class="xref py py-exc docutils literal"><span class="pre">CompositeError</span></tt> exceptions is raised, and inspect the exception
instance:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [81]: </span><span class="n">dview</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;1/0&#39;</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">CompositeError                            Traceback (most recent call last)</span>
<span class="go">/home/user/&lt;ipython-input-10-5d56b303a66c&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 dview.execute(&#39;1/0&#39;)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in execute(self, code, targets, block)</span>
<span class="go">    591                 default: self.block</span>
<span class="go">    592         &quot;&quot;&quot;</span>
<span class="go">--&gt; 593         return self._really_apply(util._execute, args=(code,), block=block, targets=targets)</span>
<span class="go">    594</span>
<span class="go">    595     def run(self, filename, targets=None, block=None):</span>

<span class="go">/home/user/&lt;string&gt; in _really_apply(self, f, args, kwargs, targets, block, track)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in sync_results(f, self, *args, **kwargs)</span>
<span class="go">     55 def sync_results(f, self, *args, **kwargs):</span>
<span class="go">     56     &quot;&quot;&quot;sync relevant results from self.client to our results attribute.&quot;&quot;&quot;</span>
<span class="go">---&gt; 57     ret = f(self, *args, **kwargs)</span>
<span class="go">     58     delta = self.outstanding.difference(self.client.outstanding)</span>
<span class="go">     59     completed = self.outstanding.intersection(delta)</span>

<span class="go">/home/user/&lt;string&gt; in _really_apply(self, f, args, kwargs, targets, block, track)</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in save_ids(f, self, *args, **kwargs)</span>
<span class="go">     44     n_previous = len(self.client.history)</span>
<span class="go">     45     try:</span>
<span class="go">---&gt; 46         ret = f(self, *args, **kwargs)</span>
<span class="go">     47     finally:</span>
<span class="go">     48         nmsgs = len(self.client.history) - n_previous</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/view.pyc in _really_apply(self, f, args, kwargs, targets, block, track)</span>
<span class="go">    529         if block:</span>
<span class="go">    530             try:</span>
<span class="go">--&gt; 531                 return ar.get()</span>
<span class="go">    532             except KeyboardInterrupt:</span>
<span class="go">    533                 pass</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/asyncresult.pyc in get(self, timeout)</span>
<span class="go">    101                 return self._result</span>
<span class="go">    102             else:</span>
<span class="go">--&gt; 103                 raise self._exception</span>
<span class="go">    104         else:</span>
<span class="go">    105             raise error.TimeoutError(&quot;Result not ready.&quot;)</span>

<span class="go">CompositeError: one or more exceptions from call to method: _execute</span>
<span class="go">[0:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[1:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[2:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[3:apply]: ZeroDivisionError: integer division or modulo by zero</span>

<span class="gp">In [82]: </span><span class="o">%</span><span class="n">debug</span>
<span class="go">&gt; /path/to/site-packages/IPython/parallel/client/asyncresult.py(103)get()</span>
<span class="go">    102             else:</span>
<span class="go">--&gt; 103                 raise self._exception</span>
<span class="go">    104         else:</span>

<span class="go">ipdb&gt; self._exception.&lt;tab&gt;</span>
<span class="go">e.__class__         e.__getitem__       e.__new__           e.__setstate__      e.args</span>
<span class="go">e.__delattr__       e.__getslice__      e.__reduce__        e.__str__           e.elist</span>
<span class="go">e.__dict__          e.__hash__          e.__reduce_ex__     e.__weakref__       e.message</span>
<span class="go">e.__doc__           e.__init__          e.__repr__          e._get_engine_str   e.print_tracebacks</span>
<span class="go">e.__getattribute__  e.__module__        e.__setattr__       e._get_traceback    e.raise_exception</span>
<span class="go">ipdb&gt; self._exception.print_tracebacks()</span>
<span class="go">[0:apply]:</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/engine/streamkernel.py&quot;, line 330, in apply_request</span>
<span class="go">    exec code in working,working</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/util.py&quot;, line 354, in _execute</span>
<span class="go">    exec code in globals()</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">ZeroDivisionError: integer division or modulo by zero</span>


<span class="go">[1:apply]:</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/engine/streamkernel.py&quot;, line 330, in apply_request</span>
<span class="go">    exec code in working,working</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/util.py&quot;, line 354, in _execute</span>
<span class="go">    exec code in globals()</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">ZeroDivisionError: integer division or modulo by zero</span>


<span class="go">[2:apply]:</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/engine/streamkernel.py&quot;, line 330, in apply_request</span>
<span class="go">    exec code in working,working</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/util.py&quot;, line 354, in _execute</span>
<span class="go">    exec code in globals()</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">ZeroDivisionError: integer division or modulo by zero</span>


<span class="go">[3:apply]:</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/engine/streamkernel.py&quot;, line 330, in apply_request</span>
<span class="go">    exec code in working,working</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">  File &quot;/path/to/site-packages/IPython/parallel/util.py&quot;, line 354, in _execute</span>
<span class="go">    exec code in globals()</span>
<span class="go">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="go">ZeroDivisionError: integer division or modulo by zero</span>
</pre></div>
</div>
<p>All of this same error handling magic even works in non-blocking mode:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [83]: </span><span class="n">dview</span><span class="o">.</span><span class="n">block</span><span class="o">=</span><span class="bp">False</span>

<span class="gp">In [84]: </span><span class="n">ar</span> <span class="o">=</span> <span class="n">dview</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&#39;1/0&#39;</span><span class="p">)</span>

<span class="gp">In [85]: </span><span class="n">ar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">CompositeError                            Traceback (most recent call last)</span>
<span class="go">/home/user/&lt;ipython-input-21-8531eb3d26fb&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 ar.get()</span>

<span class="go">/path/to/site-packages/IPython/parallel/client/asyncresult.pyc in get(self, timeout)</span>
<span class="go">    101                 return self._result</span>
<span class="go">    102             else:</span>
<span class="go">--&gt; 103                 raise self._exception</span>
<span class="go">    104         else:</span>
<span class="go">    105             raise error.TimeoutError(&quot;Result not ready.&quot;)</span>

<span class="go">CompositeError: one or more exceptions from call to method: _execute</span>
<span class="go">[0:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[1:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[2:apply]: ZeroDivisionError: integer division or modulo by zero</span>
<span class="go">[3:apply]: ZeroDivisionError: integer division or modulo by zero</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="parallel_task.html" title="The IPython task interface"
             >next</a> |</li>
        <li class="right" >
          <a href="parallel_process.html" title="Starting the IPython controller and engines"
             >previous</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li><a href="index.html" >Using IPython for parallel computing</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008, The IPython Development Team.
      Last updated on Jun 11, 2012.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>